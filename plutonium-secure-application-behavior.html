<script>
    window.PlutoniumBehaviors = window.PlutoniumBehaviors || {};
    PlutoniumBehaviors.SecureApplicationBehavior = {
        properties: {
            session: {
                type: Object,
                notify: true,
                observer: 'observeSession'
            },
            registering: {
                type: Boolean,
                notify: true,
                value: false
            }
        },
        observers: [
            'observeSession(session,registering)'
        ],
        listeners: {
            'loginWidget.unauthorized': 'onUnauthorized',
            'loginWidget.authorized': 'onAuthorized'
        },
        observeSession: function (session, registering) {
            if (!session && registering) {
                this.$.loginWidget.open();
            }
            else if (!session && !registering){
                this.$.logonWidget.open();
            } else {
                this.$.loginWidget.close();
                this.$.logonWidget.close();
            }
        },
        onUnauthorized: function (event, detail) {
            this.$.mainToast.text = 'Login unauthorized.';
            this.$.mainToast.show();
            this.$.loginWidget.open();
        },
        onAuthorized: function (event, detail) {
            this.$.mainToast.text = 'Logged in sucessfully.';
            this.$.mainToast.show();
            this.session = detail;
        }
    };
</script>